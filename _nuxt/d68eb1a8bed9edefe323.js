(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{368:function(e,t,n){},369:function(e,t,n){"use strict";n(374);var r=n(3),o=n(370),c=n(37),l=n(5),d=n(1),v=n(7),m=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var t in source)Object.prototype.hasOwnProperty.call(source,t)&&(e[t]=source[t])}return e};t.a=Object(v.a)(r.a,o.a,c.a,l.a).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,raised:Boolean,tag:{type:String,default:"div"},tile:Boolean},computed:{classes:function(){return m({"v-card":!0,"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--raised":this.raised,"v-card--tile":this.tile},this.themeClasses)},styles:function(){var style={height:Object(d.b)(this.height)};return this.img&&(style.background='url("'+this.img+'") center center / cover no-repeat'),this.height&&(style.height=Object(d.b)(this.height)),this.maxHeight&&(style.maxHeight=Object(d.b)(this.maxHeight)),this.maxWidth&&(style.maxWidth=Object(d.b)(this.maxWidth)),this.width&&(style.width=Object(d.b)(this.width)),style}},render:function(e){var t=this.generateRouteLink(this.classes),n=t.tag,data=t.data;return data.style=this.styles,e(n,this.setBackgroundColor(this.color,data),this.$slots.default)}})},370:function(e,t,n){"use strict";var r=n(0);t.a=r.a.extend({name:"measurable",props:{height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],width:[Number,String]}})},371:function(e,t,n){"use strict";var r=n(0);t.a=r.a.extend({name:"v-card-title",functional:!0,props:{primaryTitle:Boolean},render:function(e,t){var data=t.data,n=t.props,r=t.children;return data.staticClass=("v-card__title "+(data.staticClass||"")).trim(),n.primaryTitle&&(data.staticClass+=" v-card__title--primary"),e("div",data,r)}})},372:function(e,t,n){"use strict";n(108);var r=n(80);t.a=Object(r.a)("flex")},373:function(e,t,n){"use strict";n(108);var r=n(80);t.a=Object(r.a)("layout")},374:function(e,t,n){},375:function(e,t,n){},376:function(e,t,n){},377:function(e,t,n){"use strict";var r=n(368);n.n(r).a},378:function(e,t,n){},379:function(e,t,n){"use strict";var r={data:function(){return{show:!1}},props:{code:{type:String,default:""},language:{type:String,default:"javascript"},copyable:{type:Boolean,default:!1}},computed:{slotContent:function(){return this.code||this.$slots.default?(this.$slots.default[0].text||"").trim():(console.error("Missing content for code-copy element"),"[Missing content]")}},methods:{copy:function(){if(this.copyable){var e=document.createElement("textarea");e.value=this.code||this.slotContent,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.show=!0}}}},o=(n(377),n(23)),c=n(81),l=n.n(c),d=(n(378),n(3)),v=n(18),m=n(38),h=n(7),_=Object(h.a)(d.a,v.a,Object(m.b)(["absolute","top","bottom","left","right"])).extend({name:"v-snackbar",props:{autoHeight:Boolean,multiLine:Boolean,timeout:{type:Number,default:6e3},vertical:Boolean},data:function(){return{activeTimeout:-1}},computed:{classes:function(){return{"v-snack--active":this.isActive,"v-snack--absolute":this.absolute,"v-snack--auto-height":this.autoHeight,"v-snack--bottom":this.bottom||!this.top,"v-snack--left":this.left,"v-snack--multi-line":this.multiLine&&!this.vertical,"v-snack--right":this.right,"v-snack--top":this.top,"v-snack--vertical":this.vertical}}},watch:{isActive:function(){this.setTimeout()}},mounted:function(){this.setTimeout()},methods:{setTimeout:function(){var e=this;window.clearTimeout(this.activeTimeout),this.isActive&&this.timeout&&(this.activeTimeout=window.setTimeout(function(){e.isActive=!1},this.timeout))}},render:function(e){var t=[];return this.isActive&&t.push(e("div",{staticClass:"v-snack",class:this.classes,on:this.$listeners},[e("div",this.setBackgroundColor(this.color,{staticClass:"v-snack__wrapper"}),[e("div",{staticClass:"v-snack__content"},this.$slots.default)])])),e("transition",{attrs:{name:"v-snack-transition"}},t)}}),component=Object(o.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{copyable:e.copyable,copy:!0},on:{click:e.copy}},[n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs",value:e.code||e.slotContent,expression:"code || slotContent"}]},[n("code",{class:e.language})]),e._v(" "),n("v-snackbar",{attrs:{timeout:2e3},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v("\n    CopiÃ© ;-)\n  ")]),e._v(" "),n("br")],1)},[],!1,null,"55ae2834",null);t.a=component.exports;l()(component,{VSnackbar:_})},380:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(1),o=n(360),c=n(361),l=n(372),d=n(373),v=Object(r.d)("spacer","div","v-spacer");o.a,c.a,l.a,d.a},381:function(e,t,n){"use strict";var r=n(1),o=n(369),c=(n(375),n(376),n(370)),l=n(7),d=Object(l.a)(c.a).extend({name:"v-responsive",props:{aspectRatio:[String,Number]},computed:{computedAspectRatio:function(){return Number(this.aspectRatio)},aspectStyle:function(){return this.computedAspectRatio?{paddingBottom:1/this.computedAspectRatio*100+"%"}:void 0},__cachedSizer:function(){return this.aspectStyle?this.$createElement("div",{style:this.aspectStyle,staticClass:"v-responsive__sizer"}):[]}},methods:{genContent:function(){return this.$createElement("div",{staticClass:"v-responsive__content"},this.$slots.default)}},render:function(e){return e("div",{staticClass:"v-responsive",style:{height:Object(r.b)(this.height),maxHeight:Object(r.b)(this.maxHeight),maxWidth:Object(r.b)(this.maxWidth),width:Object(r.b)(this.width)},on:this.$listeners},[this.__cachedSizer,this.genContent()])}}),v=n(8),m=d.extend({name:"v-img",props:{alt:String,contain:Boolean,src:{type:[String,Object],default:""},gradient:String,lazySrc:String,srcset:String,sizes:String,position:{type:String,default:"center center"},transition:{type:[Boolean,String],default:"fade-transition"}},data:function(){return{currentSrc:"",image:null,isLoading:!0,calculatedAspectRatio:void 0}},computed:{computedAspectRatio:function(){return this.normalisedSrc.aspect},normalisedSrc:function(){return"string"==typeof this.src?{src:this.src,srcset:this.srcset,lazySrc:this.lazySrc,aspect:Number(this.aspectRatio||this.calculatedAspectRatio)}:{src:this.src.src,srcset:this.srcset||this.src.srcset,lazySrc:this.lazySrc||this.src.lazySrc,aspect:Number(this.aspectRatio||this.src.aspect||this.calculatedAspectRatio)}},__cachedImage:function(){if(!this.normalisedSrc.src&&!this.normalisedSrc.lazySrc)return[];var e=[],t=this.isLoading?this.normalisedSrc.lazySrc:this.currentSrc;this.gradient&&e.push("linear-gradient("+this.gradient+")"),t&&e.push('url("'+t+'")');var image=this.$createElement("div",{staticClass:"v-image__image",class:{"v-image__image--preload":this.isLoading,"v-image__image--contain":this.contain,"v-image__image--cover":!this.contain},style:{backgroundImage:e.join(", "),backgroundPosition:this.position},key:+this.isLoading});return this.transition?this.$createElement("transition",{attrs:{name:this.transition,mode:"in-out"}},[image]):image}},watch:{src:function(){this.isLoading?this.loadImage():this.init()},"$vuetify.breakpoint.width":"getSrc"},beforeMount:function(){this.init()},methods:{init:function(){if(this.normalisedSrc.lazySrc){var e=new Image;e.src=this.normalisedSrc.lazySrc,this.pollForSize(e,null)}this.normalisedSrc.src&&this.loadImage()},onLoad:function(){this.getSrc(),this.isLoading=!1,this.$emit("load",this.src)},onError:function(){Object(v.a)("Image load failed\n\nsrc: "+this.normalisedSrc.src,this),this.$emit("error",this.src)},getSrc:function(){this.image&&(this.currentSrc=this.image.currentSrc||this.image.src)},loadImage:function(){var e=this,image=new Image;this.image=image,image.onload=function(){image.decode?image.decode().catch(function(t){Object(v.b)("Failed to decode image, trying to render anyway\n\nsrc: "+e.normalisedSrc.src+(t.message?"\nOriginal error: "+t.message:""),e)}).then(e.onLoad):e.onLoad()},image.onerror=this.onError,image.src=this.normalisedSrc.src,this.sizes&&(image.sizes=this.sizes),this.normalisedSrc.srcset&&(image.srcset=this.normalisedSrc.srcset),this.aspectRatio||this.pollForSize(image),this.getSrc()},pollForSize:function(img){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;!function n(){var r=img.naturalHeight,o=img.naturalWidth;r||o?e.calculatedAspectRatio=o/r:null!=t&&setTimeout(n,t)}()},__genPlaceholder:function(){if(this.$slots.placeholder){var e=this.isLoading?[this.$createElement("div",{staticClass:"v-image__placeholder"},this.$slots.placeholder)]:[];return this.transition?this.$createElement("transition",{attrs:{name:this.transition}},e):e[0]}}},render:function(e){var t=d.options.render.call(this,e);return t.data.staticClass+=" v-image",t.data.attrs={role:this.alt?"img":void 0,"aria-label":this.alt},t.children=[this.__cachedSizer,this.__cachedImage,this.__genPlaceholder(),this.genContent()],e(t.tag,t.data,t.children)}}).extend({name:"v-card-media",mounted:function(){Object(v.c)("v-card-media",this.src?"v-img":"v-responsive",this)}}),h=n(371),_=n(0);n.d(t,"a",function(){return f}),n.d(t,"b",function(){return x});var f=_.a.extend(Object(r.d)("v-card__actions")),x=_.a.extend(Object(r.d)("v-card__text"));o.a,h.a},404:function(e,t,n){"use strict";n.r(t);var r={components:{CodeCopy:n(379).a},data:function(){return{example_shared_state:'const state = {}\n// or import state from "@/services/state.js"\n\nconst vueA = new Vue({\n  data: state\n})\n\nconst vueB = new Vue({\n  data(){\n    return {\n      sharedState: state,\n      privateState: {}\n    }\n  }\n})',example_store:'//store.js\nconst state = { message: "bonjour" }\n\nexport const store = {\n  get(prop){\n    if(DEBUG_MODE) console.log("[store] get", prop)\n    return state[prop]\n  },\n  set(prop, value){\n    if(DEBUG_MODE) console.log("[store] set", prop)\n    state[prop] = value\n  }\n}',example_store_template:'\x3c!-- MyComponent.vue --\x3e\n<script>\nimport store from "@/services/store.js"\n\nexport default {\n  data(){\n    return {\n      privateState: {},\n      store\n    }\n  },\n  computed: {\n    message(){\n      return this.store.get("message")\n    }\n  },\n  methods: {\n    exit(){\n      this.store.set("message", "bye!")\n    }\n  }\n}\n<\/script>',vuex_store:"import Vue from 'vue'\nimport Vuex from 'vuex'\nimport createPersistedState from 'vuex-persistedstate'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  strict: true,\n  plugins: [\n    createPersistedState()\n  ],\n  state: {\n    loggedIn: false\n  },\n  mutations: {\n    setLoggedIn (state, loggedIn) {\n      state.loggedIn = loggedIn\n    }\n  },\n  actions: {\n    setLoggedIn ({commit}, loggedIn) {\n      commit('setLoggedIn', loggedIn)\n    }\n  }\n})"}}},o=n(23),c=n(81),l=n.n(c),d=n(74),v=n(369),m=n(381),h=n(371),_=n(372),f=n(75),x=n(373),y=n(380),component=Object(o.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[n("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[n("v-card",[n("v-card-title",{staticClass:"headline primary--text"},[e._v("\n          Gestion d'Ã©tat\n        ")]),e._v(" "),n("v-card-text",[n("p",[e._v("Nous avons vu dans la section prÃ©cÃ©dente comment communiquaient les composants parents et enfants. Toutefois, Ã  mesure que les applications grandissent et se complexifient, des composants trÃ¨s Ã©loignÃ©s dans l'arborescence peuvent Ãªtre amenÃ©es Ã  manipuler les mÃªmes donnÃ©es. Il devient alors trÃ¨s fastidieux de les faire communiquer entre eux pour travailler sur les mÃªmes rÃ©fÃ©rences de donnÃ©es. C'est pourquoi il existe des solutions plus ou moins complexes de gestion d'Ã©tat, ou "),n("i",[e._v("state management")]),e._v(".")]),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            Pourquoi une solution de gestion d'Ã©tat ?\n          ")]),e._v(" "),n("img",{attrs:{src:"https://i.imgur.com/PSYBCRG.png",alt:"ProblÃ¨me multiple vues avec props partagÃ©s"}}),e._v(" "),n("ul",[n("li",[e._v("Parce que passer une variable ("),n("code",[e._v("props")]),e._v(") entre 2 composants (parent, enfant) c'est bien, mais si l'on veut la propager aux petits-enfants et arriÃ¨res petits enfants, cela devient compliquÃ©")]),e._v(" "),n("li",[e._v("Parce que partager de l'information entre des composants non liÃ©s (ex: informations de l'utilisateur connectÃ©) n'est pas rÃ©alisable.")]),e._v(" "),n("li",[e._v('Parce qu\'il est plus facile de dÃ©lÃ©guer la tÃ¢che Ã  un "singleton" tiers accessible depuis tous les composants')]),e._v(" "),n("li",[e._v('Parce qu\'il est souhaitable que le "store" puisse Ãªtre persistÃ© (sur le localStorage par ex.)')])]),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            DonnÃ©es partagÃ©es par rÃ©fÃ©rence\n          ")]),e._v(" "),n("p",[e._v("La solution la plus Ã©vidente et la plus simple au problÃ¨me de gestion d'Ã©tat est de stocker les donnÃ©es au sein d'un ou plusieurs objets dÃ©clarÃ©s dans leur propre module, puis d'exporter ces objets. Tous les composants voulant manipuler ces donnÃ©es peuvent alors importer l'objet et travailleront sur la mÃªme rÃ©fÃ©rence.")]),e._v(" "),n("code-copy",{attrs:{language:"javascript",code:e.example_shared_state}}),e._v(" "),n("p",[e._v("Cette solution peut faire l'affaire dans de nombreux cas, mais montre rapidement ses limites au dÃ©bogage lorsqu'un grand nombre de composants diffÃ©rents interagissent avec les donnÃ©es. En effet, les mutations sur les objets d'Ã©tat ne sont tracÃ©es nulle part, ce qui complexifie l'identification de la source d'un bug.")]),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            Store et mutations contrÃ´lÃ©es\n          ")]),e._v(" "),n("p",[e._v("Un pattern un peu plus avancÃ© est de dÃ©clarer un objet store qui encapsule l'objet d'Ã©tat. L'objet d'Ã©tat n'est pas directement accessible de l'extÃ©rieur par rÃ©fÃ©rence, mais le store fournit des mÃ©thodes pour interagir avec: typiquement un getter/setter. Ce sont dans ces mÃ©thodes que l'on pourra ajouter des instructions de dÃ©bogage, monitoring, mesure de performance etc.")]),e._v(" "),n("code-copy",{attrs:{language:"javascript",code:e.example_store}}),e._v(" "),n("code-copy",{attrs:{language:"html",code:e.example_store_template}}),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            Vuex\n          ")]),e._v(" "),n("p",[e._v("Une fois que l'on dispose d'un store, on est tentÃ© de l'enrichir de nombreuses fonctionnalitÃ©s en profitant de la centralisation des mutations d'Ã©tat. Cela a Ã©tÃ© un terrain de recherche pour de nombreuses Ã©quipes de dÃ©veloppement, notamment en dehors de l'Ã©cosystÃ¨me Vue avec par exemple les travaux sur l'architecture "),n("i",[e._v("Flux")]),e._v(" par l'Ã©quipe de React.")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://vuex.vuejs.org/",target:"_blank"}},[e._v("Vuex")]),e._v(" est l'aboutissement de ce pattern de store. Il est fourni par l'Ã©quipe de Vue comme solution \"officielle\" de gestion d'Ã©tat, et sert de store centralisÃ© pour tous les composants d'une application. Il fonctionne selon les principes suivants:\n          ")]),e._v(" "),n("ul",[n("li",[e._v("Une "),n("em",[e._v("mutation")]),e._v(" correspond Ã  une mÃ©thode permettant de modifier l'Ã©tat du Store. Elle est obligatoirement synchrone.")]),e._v(" "),n("li",[e._v("Une "),n("em",[e._v("action")]),e._v(" permet de dispatcher une ou plusieurs mutations. Elle peut Ãªtre asynchrone.")]),e._v(" "),n("li",[e._v("Les composants modifient l'Ã©tat applicatif en invoquant des actions")]),e._v(" "),n("li",[e._v("L'Ã©tat mutÃ© Ã  la suite de mutations met Ã  jour de faÃ§on rÃ©active toutes les vues associÃ©es, peu importe leur niveau dans l'arborescence")])]),e._v(" "),n("img",{attrs:{src:"https://vuex.vuejs.org/vuex.png",alt:"Vuex et les composants"}}),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            Installation de vuex\n          ")]),e._v(" "),n("p",[e._v("Installer la dÃ©pendance Vuex, ainsi que Vuex-PersistedState pour persister les stores dans le localStorage")]),e._v(" "),n("code-copy",{attrs:{code:"npm install vuex vuex-persistedstate",language:"shell"}}),e._v(" "),n("h2",{staticClass:"subheading primary--text pa-2"},[e._v("\n            CrÃ©ation d'un Store vuex\n          ")]),e._v(" "),n("p",[e._v("- CrÃ©er un fichier "),n("code",[e._v("src/store.js")]),e._v(", et y placer le contenu suivant")]),e._v(" "),n("code-copy",{attrs:{copyable:!0,code:e.vuex_store}}),e._v(" "),n("p",[e._v("Le mode strict permet de lancer une erreur si le store Vuex est modifiÃ© en dehors des mutateurs. "),n("span",{staticStyle:{color:"red","font-weight":"bold"}},[e._v("Attention !")]),e._v(" Ce mode doit Ãªtre dÃ©sactivÃ© en production !")]),e._v(" "),n("p",[e._v("- DÃ©clarez le store dans votre application en complÃ©tant le fichier "),n("code",[e._v("main.js")]),e._v(" comme ceci:")]),e._v(" "),n("code-copy",{attrs:{code:"import store from '@/store'\n\nnew Vue({\n  render: h => h(App),\n  store\n}).$mount('#app')\n"}}),e._v(" "),n("p",[e._v("- Pour modifier la valeur d'un Ã©lÃ©ment depuis un composant")]),e._v(" "),n("code-copy",{attrs:{code:"this.$store.dispatch('setLoggedIn', true)"}}),e._v(" "),n("p",[e._v("- Pour dÃ©clarer une variable du Store comme propriÃ©tÃ©")]),e._v(" "),n("code-copy",{attrs:{code:"import {mapState} from 'vuex'\ncomputed: {\n    ...mapState([\n      'loggedIn'\n    ])\n  }"}}),e._v(" "),n("h1",{staticClass:"headline primary--text pa-4"},[e._v("\n            TP\n          ")]),e._v(" "),n("ol",[n("li",[e._v("Installez Vuex et vue-persisted-state sur votre projet.")]),e._v(" "),n("li",[e._v("CrÃ©ez un store et mettez la variable "),n("code",[e._v("loggedIn")]),e._v(" dedans.")]),e._v(" "),n("li",[e._v("Dans "),n("code",[e._v("LoginForm.vue")]),e._v(", lors du submit, vÃ©rifier si l'utilisateur a entrÃ© l'adresse mail "),n("code",[e._v("test@test.com")]),e._v(" et le mot de passe "),n("code",[e._v("test123")]),e._v(", si c'est le cas mettre Ã  "),n("code",[e._v("true")]),e._v(" la valeur de "),n("code",[e._v("loggedIn")]),e._v(" dans le store (en utilisant un dispatch).")]),e._v(" "),n("li",[e._v("Si l'utilisateur a entrÃ© de fausses informations, afficher un message d'erreur")]),e._v(" "),n("li",[e._v("Se connecter avec les identifiants citÃ©s ci-haut, puis rafraÃ®chir la page. "),n("i",[e._v("Question: pourquoi le formulaire de login ne s'affiche plus ?")])]),e._v(" "),n("li",[e._v("Ajouter un bouton de dÃ©connexion "),n("code",[e._v('<button id="logout-btn">')]),e._v(" qui modifie la valeur de "),n("code",[e._v("loggedIn")]),e._v(" du store")])])],1),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"primary",flat:"",nuxt:"",to:"/reactivity"}},[n("v-icon",{attrs:{left:""}},[e._v("\n              navigate_before\n            ")]),e._v("\n            RÃ©activitÃ©\n          ")],1),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",flat:"",nuxt:"",to:"/routing"}},[e._v("\n            Routage\n            "),n("v-icon",{attrs:{right:""}},[e._v("\n              navigate_next\n            ")])],1)],1)],1)],1)],1)},[],!1,null,null,null);t.default=component.exports;l()(component,{VBtn:d.a,VCard:v.a,VCardActions:m.a,VCardText:m.b,VCardTitle:h.a,VFlex:_.a,VIcon:f.a,VLayout:x.a,VSpacer:y.a})}}]);